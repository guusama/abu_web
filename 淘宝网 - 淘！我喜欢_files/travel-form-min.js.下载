/*! Generated by Clam: ntrip */
KISSY.add("ntrip/mods/travel/travel-form",["node","event","base","../common/trip-form","../common/trip-common"],function(a,b){var c=b("node"),d=(b("event"),b("base")),e=b("../common/trip-form"),f=b("../common/trip-common"),g={arrCityNull:"\u8bf7\u9009\u62e9\u76ee\u7684\u5730\u57ce\u5e02",autoCompleteNull:'\u5bf9\u4e0d\u8d77\uff0c\u6ca1\u6709\u627e\u5230<span class="conve-error">"{userInput}"</span>'},h=d.extend({initializer:function(){var a=this;a.dujiaFormNode=c.one("#J_dujia_form"),a.type=c.all("#J_travelType input"),a.travelItem=c.one("#J_travel"),a.menpiaoItem=c.one("#J_menpiao"),a.depCity=c.one("#J_travelDepCity"),a.arrCity=c.one("#J_travelArrCity"),a.manpiaoFormNode=c.one("#J_menpiao_form"),a.menpiaoCity=c.one("#J_menpiaoInCity"),a._init(),a._bindUI()},_init:function(){var b=this;b.dujiaFormObj=new e({id:"#J_dujia_form",autoComplete:[{inputNode:"#J_travelDepCity",hotSource:"//www.alitrip.com/go/rgn/trip/dujiadephotcity_jsonp.php",source:"//s.alitrip.com/suggest/word_suggest.htm?max=10&q={query}&type=1&_input_charset=UTF-8",resultListLocator:"result",wrapperClass:"conve-complete J_convePop",resultTextLocator:"areaName",width:b.depCity.parent(".conve-input").outerWidth(),align:{node:b.depCity.parent(".conve-input"),points:["br","tr"]},resultFormatter:function(b,c){return a.map(c,function(b){return a.substitute('<div class="ks-ac-item-inner"><span class="ks-ac-name">{cityname}</span></div>',{cityname:b.text})})}},{inputNode:"#J_travelArrCity",hotSource:"//www.alitrip.com/go/rgn/trip/dujiaarrhotcity_jsonp.php",source:"//s.alitrip.com/suggest/word_suggest.htm?type=2&q={query}&_input_charset=UTF-8",resultListLocator:"result",wrapperClass:"conve-complete J_convePop",resultTextLocator:"areaName",width:b.arrCity.parent(".conve-input").outerWidth(),align:{node:b.arrCity.parent(".conve-input"),points:["br","tr"]},resultFormatter:function(b,c){return a.map(c,function(b){return a.substitute('<div class="ks-ac-item-inner"><span class="ks-ac-name">{cityname}</span></div>',{cityname:b.text})})}}]}),b.menpiaoFormObj=new e({id:"#J_menpiao_form"}),b.depCityAutoComplete=b.dujiaFormObj.getAutoCompleteById("#J_travelDepCity"),b.arrCityAutoComplete=b.dujiaFormObj.getAutoCompleteById("#J_travelArrCity")},_bindUI:function(){var a=this;a.dujiaFormNode.on("submit",a.submitForm,a),a.type.on("click",a.changeType,a),a.manpiaoFormNode.on("submit",function(){a.manpiaoFormNode.getDOMNode().submit()},a),a.menpiaoCity.on("focus",function(a){var b=c.one(a.currentTarget);b.parent(".conve-input").addClass("conve-input-expand")}),a.menpiaoCity.on("blur",function(a){var b=c.one(a.currentTarget);b.parent(".conve-input").removeClass("conve-input-expand")})},submitForm:function(){var a=this;a._validate()&&(a.dujiaFormObj.storeFormInfo(),a.dujiaFormNode.getDOMNode().submit())},changeType:function(a){var b=this;b.typeVal=c.one(a.currentTarget).val(),0==b.typeVal?(b.travelItem.show(),b.menpiaoItem.hide()):(b.travelItem.hide(),b.menpiaoItem.show())},_validate:function(){var a=this;return f.checkNull(a.arrCity)?!0:(a.arrCityAutoComplete.showMessage(g.arrCityNull),!1)}});return h});