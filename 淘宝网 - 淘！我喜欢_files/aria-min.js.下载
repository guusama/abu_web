/*! Generated by Clam: ntrip */
KISSY.add("ntrip/mods/autocomplete/aria",["node","event"],function(a,b){var c=b("node"),d=(b("event"),"J_AcItem"),e=".J_TabItem",f="."+d,g=function(){this.initAria.apply(this,arguments)};return g.ATTRS={},g.prototype={nodeArr:null,isFirstShow:!0,initAria:function(){this.bindAria(),this.nodeArr=null},bindAria:function(){this.on("afterHotActiveTabChange",function(a){var b=this.hotNavNodes.item(a.newVal),c=this.hotPannelNodes.item(a.newVal),d=this.hotItemNodes=c.all(f);this.nodeArr=this.buildArr2(d),this.isFirstShow?this.isFirstShow=!1:b.one("a")&&b.one("a")[0].focus()},this),this.on("afterHotSourceChange",function(){this.isFirstShow=!0},this),this.hotNode.delegate("keydown",f,function(a){var b=c.one(a.currentTarget),e=b.data("src");if(b.hasClass(d)&&b.hasData("src"))switch(a.keyCode){case 37:a.preventDefault(),this._selectHotLeft(e);break;case 38:a.preventDefault(),this._selectHotTop(e);break;case 39:a.preventDefault(),this._selectHotRight(e);break;case 40:a.preventDefault(),this._selectHotBottom(e)}},this),this.hotNode.delegate("keydown",e,function(a){var b=this.get("hotActiveTab");switch(a.keyCode){case 37:b--,0>b&&(b=this.hotNavNodes.length-1),this.set("hotActiveTab",b);break;case 39:b++,b>=this.hotNavNodes.length&&(b=0),this.set("hotActiveTab",b);break;case 38:this.hotItemNodes.item(0)[0].focus();break;case 40:this.hotItemNodes.item(0)[0].focus();break;case 9:a.preventDefault(),this.hotItemNodes.item(0)[0].focus()}},this)},buildArr2:function(b){var d=[],e={};return b.each(function(b){b=c.one(b);var d=b.offset();a.isArray(e[d.top])||(e[d.top]=[]),e[d.top].push({node:b,offset:d,x:e[d.top].length})}),a.each(e,function(a,b){d.push(b)}),d.sort(function(a,b){return a-b}),a.each(d,function(b,c){a.each(e[b],function(a){a.y=c,a.node.data("src",a)}),d[c]=e[b]}),d},_selectHotTop:function(a){var b=a.x,c=a.y;c--,0>c&&(c=this.nodeArr.length-1),this._selectHot(b,c,"up")},_selectHotBottom:function(a){var b=a.x,c=a.y;c++,c>=this.nodeArr.length&&(c=0),this._selectHot(b,c,"down")},_selectHotLeft:function(a){var b=a.x,c=a.y;b--,0>b&&(c--,0>c&&(c=this.nodeArr.length-1),b=this.nodeArr[c].length-1),this._selectHot(b,c)},_selectHotRight:function(a){var b=a.x,c=a.y;b++,b>=this.nodeArr[a.y].length&&(b=0,c++,c>=this.nodeArr.length&&(c=0)),this._selectHot(b,c)},_selectHot:function(a,b,c){if(this.nodeArr[b])if(this.nodeArr[b][a])this.nodeArr[b][a].node[0].focus();else{if("up"===c)return b--,this._selectHot(a,b,c),!1;if("down"===c)return b++,this._selectHot(a,b,c),!1}}},g});